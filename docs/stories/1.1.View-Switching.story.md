# Story 1.1: View Switching

## Status
Draft

## Story
**As a** user,
**I want** to select 'Hourly', 'Daily', 'Weekly', or 'Monthly' from a dropdown menu,
**so that** I can view my timeline at my preferred level of detail.

## Acceptance Criteria
1. A dropdown menu is present in the main UI.
2. Selecting an option from the dropdown immediately re-renders the timeline view to the corresponding scale.
3. The timeline grid and ticket displays adjust logically for each view.

## Tasks / Subtasks
- [ ] **Task 1 (AC: 1)**: Modify the `TimelineHeader` component to add a view-switching dropdown.
  - [ ] Subtask 1.1: Add a dropdown menu to `TimelineHeader.tsx` with options: 'Hourly', 'Daily', 'Weekly', 'Monthly'.
- [ ] **Task 2 (AC: 2, 3)**: Enhance the `useTimeline` hook to manage view state and data loading.
  - [ ] Subtask 2.1: In `useTimeline.ts`, add state to track the current view ('hourly', 'daily', 'weekly', 'monthly').
  - [ ] Subtask 2.2: Create a handler function in the hook to update the view state.
  - [ ] Subtask 2.3: Implement data loading logic that switches between detailed data (hourly/daily/weekly) and aggregated data (monthly).
  - [ ] Subtask 2.4: Adjust the `currentScale` calculation based on the selected view state.
- [ ] **Task 3 (AC: 2, 3)**: Implement the timeline rendering logic.
    - [ ] Subtask 3.1: The `Timeline` component should subscribe to the `timelineSlice` state.
    - [ ] Subtask 3.2: Based on the current view state, render appropriate view: detailed timeline for hourly/daily/weekly or monthly calendar grid for monthly view.
    - [ ] Subtask 3.3: Implement view-specific data loading (detailed vs aggregated) and rendering logic.

## Dev Notes

### Previous Story Insights
No previous story. This is the first story in the epic.

### Data Models
        *   **Data Behavior:** Hourly/Daily/Weekly views load detailed ticket data; Monthly view loads aggregated summary data and displays as calendar grid with drill-down capability.
- The system needs to handle two distinct data types based on the selected view
[Source: docs/brownfield-architecture/3-proposed-architecture.md]

### API Specifications
**Data Loading Strategy**:
- **Hourly/Daily/Weekly views**: Use existing detailed ticket endpoints
- **Monthly view**: May require new API endpoint for aggregated/summary data
- The component needs to detect view changes and fetch appropriate data accordingly
[Source: docs/brownfield-architecture/3-proposed-architecture.md]

### Component Specifications
- **`Timeline`**: The main component at `packages/frontend/src/components/timeline/components/Timeline.tsx`. This will be the top-level container for the view.
- **`TimelineHeader`**: The component at `packages/frontend/src/components/timeline/components/TimelineHeader.tsx`. This is where the view-switching dropdown will be added.
- **`useTimeline`**: The hook at `packages/frontend/src/components/timeline/hooks/useTimeline.ts`. This will be modified to handle the view-switching logic.
[Source: docs/brownfield-architecture/3-proposed-architecture.md#new-components, docs/brownfield-architecture/4-source-tree-integration.md]

### File Locations
- Main component: `packages/frontend/src/components/timeline/components/Timeline.tsx`
- Header component: `packages/frontend/src/components/timeline/components/TimelineHeader.tsx`
- Hook for logic: `packages/frontend/src/components/timeline/hooks/useTimeline.ts`
[Source: docs/brownfield-architecture/4-source-tree-integration.md]

### Testing Requirements
- Unit tests should be created for the modified components.
- Tests should verify that:
  - The dropdown renders with the correct options.
  - Selecting an option updates the view state correctly.
  - **CRITICAL**: Switching to monthly view triggers different data loading behavior.
  - **CRITICAL**: Switching between hourly/daily/weekly maintains the same data but changes visual representation.
  - The component renders the correct grid layout and data for each view option.
[Source: docs/brownfield-architecture/2-architectural-goals-constraints.md]

### Technical Constraints
- Must use the existing Next.js frontend and Redux Toolkit for state management.
[Source: docs/brownfield-architecture/1-introduction.md, docs/brownfield-architecture/2-architectural-goals-constraints.md]

## Change Log

| Date       | Version | Description                | Author        |
|------------|---------|----------------------------|---------------|
| 2025-07-24 | 1.0     | Initial draft of the story | Bob (Scrum Master) |

## Dev Agent Record
*This section will be populated by the development agent during implementation.*

## QA Results
*This section will be populated by the QA agent after the story is implemented.*
